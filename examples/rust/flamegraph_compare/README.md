# Flamegraph Comparison Tool

A visual tool for comparing two flamegraphs (baseline vs optimized) built with egui.

## Features

- **Visual Comparison**: Side-by-side comparison of flamegraph performance data
- **Interactive Filtering**: Search, filter by improvements/regressions, set minimum thresholds
- **Multiple Formats**: Supports SVG, collapsed stack format, and JSON
- **Sortable Table**: Sort by function name, baseline/optimized percentages, or change percentage
- **Visual Indicators**: Color-coded bars showing improvements (green) and regressions (red)
- **File Browser**: Built-in file picker for easy file selection

## Usage

### From Command Line

```bash
# Build and run with file paths
cargo run -p flamegraph_compare -- baseline.svg optimized.svg

# Run without arguments to use the GUI file picker
cargo run -p flamegraph_compare
```

### Using the GUI

1. **Load Flamegraphs**:
   - Click "ðŸ“ Browse" to select baseline and optimized flamegraph files
   - Click "ðŸ”„ Load & Compare" to analyze

2. **View Summary**:
   - See overall statistics including total samples and overall change percentage
   - View counts of improvements and regressions

3. **Filter Results**:
   - Use the search box to filter by function name
   - Toggle "Show only improvements" or "Show only regressions"
   - Adjust minimum change threshold slider to hide small changes

4. **Sort Results**:
   - Click column headers to sort by:
     - Function Name
     - Baseline % (time spent)
     - Optimized % (time spent)
     - Change % (improvement or regression)

## Supported Formats

- **SVG**: Interactive flamegraph SVG files (most common, generated by flamegraph.pl)
- **Collapsed**: Standard flamegraph format (`func1;func2;func3 100`)
- **JSON**: JSON format with stack arrays (for tools like puffin)

## Interpreting Results

- **Green**: Functions that improved (reduced time)
- **Red**: Functions that regressed (increased time)
- **Positive %**: Regression (slower in optimized version)
- **Negative %**: Improvement (faster in optimized version)

## Example

```bash
# Generate flamegraphs using perf and flamegraph.pl
perf record -g ./my_program_baseline
perf script | stackcollapse-perf.pl | flamegraph.pl > baseline.svg

# After optimization
perf record -g ./my_program_optimized
perf script | stackcollapse-perf.pl | flamegraph.pl > optimized.svg

# Compare them visually
cargo run -p flamegraph_compare -- baseline.svg optimized.svg
```
